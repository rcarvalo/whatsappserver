<mxfile host="app.diagrams.net" modified="2024-01-15T10:00:00.000Z" agent="5.0">
  <diagram name="Flux Extraction vers RAG" id="extraction-rag-flow">
    <mxGraphModel dx="1422" dy="758" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Titre -->
        <mxCell id="title" value="ðŸ”„ Flux d'Information: Extraction LLM â†’ RAG" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="400" height="30" as="geometry" />
        </mxCell>

        <!-- 1. Message WhatsApp entrant -->
        <mxCell id="whatsapp-message" value="ðŸ“± Message WhatsApp&#xa;&#xa;'Salut! Je vends ma Rolex&#xa;Submariner Hulk 116610LV&#xa;Ã‰tat neuf, boÃ®te + papiers&#xa;Prix: 12500â‚¬ nÃ©gociable'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="50" y="100" width="200" height="120" as="geometry" />
        </mxCell>

        <!-- 2. Webhook Processing -->
        <mxCell id="webhook-processing" value="ðŸ”— Traitement Webhook&#xa;&#xa;â€¢ Extraction mÃ©tadonnÃ©es WhatsApp&#xa;â€¢ Contexte de groupe&#xa;â€¢ Profil expÃ©diteur&#xa;â€¢ Signaux d'intention" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="320" y="100" width="180" height="120" as="geometry" />
        </mxCell>

        <!-- 3. LLM Extractor -->
        <mxCell id="llm-extractor" value="ðŸ¤– Extracteur LLM&#xa;(GPT-4o-mini)&#xa;&#xa;â€¢ Prompt structurÃ© expert&#xa;â€¢ Contexte horlogerie&#xa;â€¢ JSON Schema strict&#xa;â€¢ Raisonnement explicable" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="560" y="100" width="180" height="120" as="geometry" />
        </mxCell>

        <!-- 4. DonnÃ©es StructurÃ©es -->
        <mxCell id="structured-data" value="ðŸ“Š DonnÃ©es StructurÃ©es&#xa;&#xa;â€¢ Marque: Rolex&#xa;â€¢ ModÃ¨le: Submariner&#xa;â€¢ Ref: 116610LV&#xa;â€¢ Prix: 12500â‚¬&#xa;â€¢ Accessoires: [box, papers]&#xa;â€¢ Confiance: 0.95" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="800" y="100" width="180" height="120" as="geometry" />
        </mxCell>

        <!-- 5. Enrichissement MÃ©tadonnÃ©es -->
        <mxCell id="metadata-enrichment" value="âœ¨ Enrichissement&#xa;MÃ©tadonnÃ©es&#xa;&#xa;â€¢ Mots-clÃ©s sÃ©mantiques&#xa;â€¢ Classification intentions&#xa;â€¢ Scores sentiment&#xa;â€¢ Contexte temporel" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="50" y="280" width="180" height="120" as="geometry" />
        </mxCell>

        <!-- 6. Embedding Enrichi -->
        <mxCell id="enhanced-embedding" value="ðŸŽ¯ Embedding Enrichi&#xa;&#xa;Texte original +&#xa;[GROUPE: Montres Premium]&#xa;[MARQUE: Rolex]&#xa;[INTENTION: VENTE]&#xa;[LANGUE: FRENCH]&#xa;â†’ Vector 1536D" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="290" y="280" width="200" height="120" as="geometry" />
        </mxCell>

        <!-- 7. Base de DonnÃ©es -->
        <mxCell id="database" value="ðŸ—„ï¸ Base de DonnÃ©es&#xa;(watch_conversations)&#xa;&#xa;â€¢ 25+ champs structurÃ©s&#xa;â€¢ Embedding vectoriel&#xa;â€¢ Index optimisÃ©s&#xa;â€¢ MÃ©tadonnÃ©es JSON" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="550" y="280" width="180" height="120" as="geometry" />
        </mxCell>

        <!-- 8. Recherche RAG -->
        <mxCell id="rag-search" value="ðŸ” Recherche RAG&#xa;&#xa;â€¢ SimilaritÃ© vectorielle&#xa;â€¢ Filtres avancÃ©s&#xa;â€¢ Fonctions SQL custom&#xa;â€¢ Ranking intelligent" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="800" y="280" width="180" height="120" as="geometry" />
        </mxCell>

        <!-- 9. Interface Utilisateur -->
        <mxCell id="user-interface" value="ðŸ¤– Interface Utilisateur&#xa;(Telegram Bot)&#xa;&#xa;â€¢ Recherche naturelle&#xa;â€¢ RÃ©sultats enrichis&#xa;â€¢ Filtres intelligents&#xa;â€¢ Statistiques temps rÃ©el" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="420" y="460" width="200" height="120" as="geometry" />
        </mxCell>

        <!-- FlÃ¨ches de flux -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="whatsapp-message" target="webhook-processing">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="webhook-processing" target="llm-extractor">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="llm-extractor" target="structured-data">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="structured-data" target="metadata-enrichment">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="890" y="250" />
              <mxPoint x="140" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="metadata-enrichment" target="enhanced-embedding">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="enhanced-embedding" target="database">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="database" target="rag-search">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="rag-search" target="user-interface">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="890" y="430" />
              <mxPoint x="520" y="430" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Labels des flÃ¨ches -->
        <mxCell id="label1" value="MÃ©tadonnÃ©es&#xa;WhatsApp" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="270" y="130" width="60" height="30" as="geometry" />
        </mxCell>

        <mxCell id="label2" value="Prompt +&#xa;Contexte" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="510" y="130" width="50" height="30" as="geometry" />
        </mxCell>

        <mxCell id="label3" value="JSON&#xa;StructurÃ©" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="750" y="130" width="50" height="30" as="geometry" />
        </mxCell>

        <mxCell id="label4" value="Normalisation" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="500" y="230" width="70" height="20" as="geometry" />
        </mxCell>

        <mxCell id="label5" value="Mots-clÃ©s&#xa;Enrichis" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="240" y="320" width="50" height="30" as="geometry" />
        </mxCell>

        <mxCell id="label6" value="Vector +&#xa;MÃ©tadonnÃ©es" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="500" y="320" width="50" height="30" as="geometry" />
        </mxCell>

        <mxCell id="label7" value="RequÃªtes&#xa;OptimisÃ©es" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="750" y="320" width="50" height="30" as="geometry" />
        </mxCell>

        <mxCell id="label8" value="RÃ©sultats&#xa;Intelligents" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="680" y="410" width="50" height="30" as="geometry" />
        </mxCell>

        <!-- LÃ©gende -->
        <mxCell id="legend-title" value="ðŸŽ¯ Optimisations ClÃ©s" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="50" y="620" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend1" value="â€¢ Cache LLM: Ã©vite appels redondants" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="50" y="650" width="250" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend2" value="â€¢ Embedding enrichi: +50% prÃ©cision recherche" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="50" y="670" width="250" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend3" value="â€¢ Index vectoriels: recherche <100ms" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="50" y="690" width="250" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend4" value="â€¢ MÃ©tadonnÃ©es JSON: filtrage avancÃ©" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="50" y="710" width="250" height="20" as="geometry" />
        </mxCell>

        <!-- Performance Box -->
        <mxCell id="perf-box" value="âš¡ Performances&#xa;&#xa;â€¢ Extraction LLM: ~1s&#xa;â€¢ Cache hit: &lt;50ms&#xa;â€¢ Recherche RAG: &lt;100ms&#xa;â€¢ PrÃ©cision: 90%+&#xa;â€¢ CoÃ»t: ~$0.0001/msg" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0f0f0;strokeColor=#666666;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="800" y="620" width="180" height="120" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
